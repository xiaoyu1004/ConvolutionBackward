#ifndef COMMON_H
#define COMMON_H

#ifdef ENABLE_CUDA
#include <cuda_runtime.h>
#ifdef ENABLE_CUDNN
#include <cudnn.h>
#endif
#endif

#include <iostream>
#include <algorithm>

#define CUDA_CHECK(err)                                                                                     \
    if (err != cudaSuccess)                                                                                 \
    {                                                                                                       \
        printf("cuda error: file: %s line: %d details: %s\n", __FILE__, __LINE__, cudaGetErrorString(err)); \
        std::terminate();                                                                                   \
    }

#define CUDNN_CHECK(err)                                                                                      \
    if (err != CUDNN_STATUS_SUCCESS)                                                                          \
    {                                                                                                         \
        printf("cudnn error: file: %s line: %d details: %s\n", __FILE__, __LINE__, cudnnGetErrorString(err)); \
        std::terminate();                                                                                     \
    }

static float x_data[280] = {
    0.757686f, 0.453634f, 0.412995f, 0.558537f, 0.116952f, 0.557779f,
    0.668119f, 0.927466f, 0.344328f, 0.680014f, 0.999756f, 0.285515f,
    0.975296f, 0.251754f, 0.720397f, 0.695875f, 0.639664f, 0.895402f,
    0.297918f, 0.63141f, 0.502806f, 0.123929f, 0.378593f, 0.166088f,
    0.721078f, 0.544948f, 0.548982f, 0.348315f, 0.502404f, 0.344478f,
    0.643668f, 0.985585f, 0.575735f, 0.278541f, 0.194586f, 0.53822f,
    0.129077f, 0.124175f, 0.174562f, 0.330178f, 0.537009f, 0.844306f,
    0.69367f, 0.883059f, 0.186051f, 0.542194f, 0.0555596f, 0.786829f,
    0.604205f, 0.983607f, 0.144394f, 0.900965f, 0.922113f, 0.904259f,
    0.571347f, 0.95464f, 0.833917f, 0.87304f, 0.46752f, 0.116301f,
    0.493778f, 0.593769f, 0.159415f, 0.21318f, 0.0206268f, 0.324726f,
    0.935534f, 0.585498f, 0.46946f, 0.520079f, 0.811773f, 0.0584682f,
    0.114205f, 0.333765f, 0.212241f, 0.757893f, 0.853292f, 0.0148871f,
    0.0756602f, 0.0130911f, 0.688627f, 0.902427f, 0.11233f, 0.268522f,
    0.65911f, 0.173507f, 0.92474f, 0.616581f, 0.360808f, 0.532475f,
    0.655884f, 0.323193f, 0.112572f, 0.503361f, 0.509107f, 0.510083f,
    0.427035f, 0.821037f, 0.36047f, 0.451604f, 0.705594f, 0.185281f,
    0.633879f, 0.389442f, 0.739837f, 0.228768f, 0.518479f, 0.548915f,
    0.0977017f, 0.136429f, 0.691757f, 0.354472f, 0.796948f, 0.00606871f,
    0.252836f, 0.088169f, 0.699736f, 0.485504f, 0.406739f, 0.416814f,
    0.109176f, 0.641797f, 0.512463f, 0.154944f, 0.688144f, 0.48995f,
    0.0164262f, 0.76896f, 0.767444f, 0.405795f, 0.154781f, 0.520075f,
    0.87729f, 0.95767f, 0.122599f, 0.274166f, 0.889312f, 0.744389f,
    0.809506f, 0.251133f, 0.930767f, 0.088967f, 0.475916f, 0.510381f,
    0.583984f, 0.122708f, 0.958733f, 0.991387f, 0.154696f, 0.51847f,
    0.233669f, 0.979442f, 0.778833f, 0.79445f, 0.661302f, 0.450222f,
    0.781531f, 0.508514f, 0.317642f, 0.758154f, 5.65004f, 6.3569f,
    5.60525f, 6.49767f, 6.43702f, 5.84833f, 6.53571f, 7.10961f, 5.75656f,
    6.67309f, 7.07555f, 5.70418f, 6.02197f, 6.11981f, 6.60903f, 6.22834f,
    5.92529f, 6.33948f, 6.77514f, 7.42683f, 5.91257f, 5.08429f, 5.65004f,
    6.3569f, 6.92362f, 5.89331f, 6.43302f, 7.55648f, 5.74087f, 5.60525f,
    6.49767f, 6.43702f, 5.84833f, 6.53571f, 7.10961f, 5.75656f, 6.67309f,
    7.07555f, 5.70418f, 6.02197f, 6.11981f, 6.60903f, 6.22834f, 5.92529f,
    6.33948f, 6.77514f, 7.42683f, 5.91257f, 5.08429f, 5.41056f, 5.69596f,
    6.03819f, 4.34759f, 5.13341f, 5.99422f, 4.97968f, 5.36167f, 5.02113f,
    5.19592f, 4.61581f, 5.26459f, 6.19205f, 3.98156f, 4.31164f, 6.86429f,
    5.17407f, 4.34305f, 5.5019f, 4.61968f, 6.27718f, 7.13943f, 5.43655f,
    6.13176f, 8.17839f, 6.22879f, 5.53269f, 5.41056f, 5.69596f, 6.03819f,
    4.34759f, 5.13341f, 5.99422f, 4.97968f, 5.36167f, 5.02113f, 5.19592f,
    4.61581f, 5.26459f, 6.19205f, 3.98156f, 4.31164f, 6.86429f, 5.17407f,
    4.34305f, 5.5019f, 4.61968f, 6.27718f, 7.13943f, 5.43655f, 6.13176f,
    8.17839f, 6.22879f, 5.53269f, 6.92362f, 5.89331f, 6.43302f, 7.55648f,
    5.74087f, 2.24707f, 0.93021f, 1.69041f, 0.12371f, 0.69699f, 1.46659f,
    0.12014f, 2.18352f, 1.10718f, 0.74742f, 1.33128f, 0.90814f};

#endif